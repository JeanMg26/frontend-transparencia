import{C as z,r as u,o as C,D as c,H as b,G as e,F as o,N as X,O as a,J as U,I as ie,L as q,E as $,Q as D,_ as O,P as te,R as se,a0 as ue,w as P,M as H,v as L,aq as ae,T as k,q as ce,a1 as de}from"./index.4f03f91b.js";import{Q as me}from"./QPage.93c896a6.js";import{Q as V}from"./QSpinnerBars.faaa4498.js";import{Q as le}from"./QInnerLoading.87f5c047.js";import{u as Q}from"./User.2441d555.js";import{Q as A}from"./QTooltip.0294f36c.js";import{Q as pe,a as fe,N as ve}from"./NoResults.67ae0d4a.js";import{Q as T,a as M}from"./QCard.15344bc4.js";import{Q as W}from"./QInput.d45c9e43.js";import{Q as ge,u as _e,f as ye,e as he}from"./validation.d8c4b050.js";import{Q as G}from"./QDialog.a4be6c36.js";import{C as N}from"./ClosePopup.0885fbba.js";import{u as be}from"./use-quasar.907afb26.js";import{c as Ue,n as w,A as j,u as xe,d as Se,r as De,e as ke}from"./api_rest.be0b8500.js";import"./use-dark.187236d0.js";import"./use-transition.9e1010fb.js";import"./position-engine.11586397.js";import"./selection.82da9296.js";import"./focus-manager.02955f48.js";import"./use-model-toggle.422ce669.js";import"./format.2bc25e5f.js";import"./uid.42677368.js";import"./use-prevent-scroll.adeeee81.js";import"./axios.beb5d2fc.js";const I=r=>(te("data-v-36557792"),r=r(),se(),r),qe=I(()=>a("thead",{class:"bg-grey-2"},[a("tr",null,[a("th",{class:"text-left"},"Nombre de Usuario"),a("th",{class:"text-left"},"Nombres Completos"),a("th",{class:"text-left"},"Correo Electr\xF3nico"),a("th",{class:"text-left"},"Estado"),a("th",{class:"text-right"},"Acciones")])],-1)),$e={key:0},Ce={colspan:"5"},Ee={class:"text-left"},Ve={class:"text-left"},we={class:"text-left"},ze={class:"text-left"},Qe={key:0,class:"text-positive"},Ie={key:1,class:"text-red"},Fe={class:"text-right"},Be={class:"q-gutter-x-md"},Re=I(()=>a("span",null,"Habilitar",-1)),Ae=I(()=>a("span",null,"Deshabilitar",-1)),Pe=I(()=>a("span",null,"Editar",-1)),Le=I(()=>a("span",null,"Eliminar",-1)),Te=I(()=>a("span",null,"Resetar Contrase\xF1a",-1)),Ne=z({__name:"TableUserDesktop",props:{openDialogUpdateUser:{type:Function,required:!0},openDialogDeleteUser:{type:Function,required:!0},openDialogResetUser:{type:Function,required:!0},openChangeStatusUser:{type:Function,required:!0}},setup(r){const f=Q(),v=u(1),n=C(()=>f.users),m=C(()=>f.isLoadingTable);return(d,t)=>(c(),b(X,null,[e(pe,{flat:"",bordered:""},{default:o(()=>{var i,l;return[qe,a("tbody",null,[(i=n.value)!=null&&i.length?U("",!0):(c(),b("tr",$e,[a("td",Ce,[e(ve)])])),(l=n.value)!=null&&l.length?(c(!0),b(X,{key:1},ie(n.value,(s,h)=>(c(),b("tr",{key:h},[a("td",Ee,q(s.username),1),a("td",Ve,q(s.name),1),a("td",we,q(s.email),1),a("td",ze,[s.active==1?(c(),b("span",Qe,"Activo")):U("",!0),s.active==0?(c(),b("span",Ie,"Inactivo")):U("",!0)]),a("td",Fe,[a("div",Be,[s.active==0?(c(),$(D,{key:0,name:"fa-solid fa-circle-check",color:"positive",class:"cursor-pointer",onClick:y=>r.openChangeStatusUser(s)},{default:o(()=>[e(A,{anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:o(()=>[Re]),_:1})]),_:2},1032,["onClick"])):U("",!0),s.active==1?(c(),$(D,{key:1,name:"fa-solid fa-circle-xmark",color:"negative",class:"cursor-pointer",onClick:y=>r.openChangeStatusUser(s)},{default:o(()=>[e(A,{anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:o(()=>[Ae]),_:1})]),_:2},1032,["onClick"])):U("",!0),e(D,{name:"fa-solid fa-edit",color:"primary",class:"cursor-pointer",onClick:y=>r.openDialogUpdateUser(s.id)},{default:o(()=>[e(A,{anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:o(()=>[Pe]),_:1})]),_:2},1032,["onClick"]),e(D,{name:"fa-regular fa-trash-can",color:"red",class:"cursor-pointer",onClick:y=>r.openDialogDeleteUser(s)},{default:o(()=>[e(A,{anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:o(()=>[Le]),_:1})]),_:2},1032,["onClick"]),e(D,{name:"fa-solid fa-power-off",color:"positive",class:"cursor-pointer",onClick:y=>r.openDialogResetUser(s)},{default:o(()=>[e(A,{anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:o(()=>[Te]),_:1})]),_:2},1032,["onClick"])])])]))),128)):U("",!0)]),e(le,{showing:m.value},{default:o(()=>[e(V,{size:"35px",color:"primary"})]),_:1},8,["showing"])]}),_:1}),e(fe,{size:"0.8rem",class:"fles justify-end q-mt-md",modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=i=>v.value=i),max:"1","direction-links":"",outline:"",color:"primary","active-design":"unelevated","active-color":"primary","active-text-color":"white"},null,8,["modelValue"])],64))}});var je=O(Ne,[["__scopeId","data-v-36557792"]]);const Y=r=>(te("data-v-58bcdd20"),r=r(),se(),r),Oe={class:"flex justify-between items-center"},He={key:0,class:"text-header"},Me={key:1,class:"text-header"},Ge={class:"row"},Je={class:"col-12"},Ke=Y(()=>a("span",{class:"q-label-input"},"Nombre de usuario",-1)),We={key:0,class:"q-label-error"},Xe={class:"col-12 q-mt-sm"},Ye=Y(()=>a("span",{class:"q-label-input"},"Nombres Completos",-1)),Ze={class:"col-12 q-mt-sm"},ea=Y(()=>a("span",{class:"q-label-input"},"Correo electr\xF3nico",-1)),aa={key:0,class:"q-label-error"},ta={class:"col-12 q-mt-lg"},sa={class:"btn-actions q-gutter-x-md"},la=z({__name:"DialogOperationUser",props:{openDialog:{type:Boolean,required:!0}},setup(r){const f=r,v=be(),n=Q(),m=u(!1),d=u(null),t=ue({username:"",fullname:"",email:""}),i=u(null),l=u(null),s=u(null),h=u(!1),y=u(""),g=u(""),E=()=>{i.value.resetValidation()},F=()=>{l.value.resetValidation()},J=()=>{s.value.resetValidation()},S=C(()=>n.user),K=C({get(){return t.username?t.username:S.value.username},set(x){t.username=x}}),Z=C({get(){return t.fullname?t.fullname:S.value.name},set(x){t.fullname=x}}),ee=C({get(){return t.email?t.email:S.value.email},set(x){t.email=x}}),oe=async()=>{var x,p;h.value=!0;try{await Ue({name:t.fullname,username:t.username,email:t.email}),h.value=!1,d.value.hide(),w("success","Usuario creado correctamente."),n.isLoadingTable=!0,await n.getUsersStore()}catch(_){if(_ instanceof j){let B=(x=_.response)==null?void 0:x.data.errors.email,R=(p=_.response)==null?void 0:p.data.errors.username;R&&R[0]==1001&&(y.value="Este usuario ya est\xE1 registrado"),B&&B[0]==1002&&(g.value="Este email ya esta registrado")}}},re=async()=>{var x,p;h.value=!0;try{await xe(S.value.id,{name:t.fullname?t.fullname:S.value.name,username:t.username?t.username:S.value.username,email:t.email?t.email:S.value.email}),h.value=!1,d.value.hide(),w("success","Usuario actualizado correctamente."),n.isLoadingTable=!0,await n.getUsersStore()}catch(_){if(_ instanceof j){let B=(x=_.response)==null?void 0:x.data.errors.email,R=(p=_.response)==null?void 0:p.data.errors.username;R&&R[0]==1001&&(y.value="Este usuario ya est\xE1 registrado"),B&&B[0]==1002&&(g.value="Este email ya esta registrado")}}},ne=async()=>{S.value.id?re():oe()};return P(()=>f.openDialog,()=>{m.value=!0}),P(m,()=>{m.value||(n.clearUserStore(),t.email="",t.fullname="",t.username="",y.value="",g.value="")}),(x,p)=>(c(),$(G,{modelValue:m.value,"onUpdate:modelValue":p[6]||(p[6]=_=>m.value=_),persistent:"",ref_key:"refDialog",ref:d,position:H(v).screen.width<600?"bottom":"standard"},{default:o(()=>[e(M,{class:"card-user"},{default:o(()=>[e(T,null,{default:o(()=>[a("div",Oe,[S.value.id?(c(),b("span",Me,"Actualizar un usuario")):(c(),b("span",He," Agregar un nuevo usuario ")),L(e(D,{name:"fa-solid fa-xmark",class:"cursor-pointer",size:"1rem"},null,512),[[N]])])]),_:1}),e(ge,{onSubmit:ne,greedy:"","no-error-focus":""},{default:o(()=>[e(T,{class:"q-pt-none"},{default:o(()=>[a("div",Ge,[a("div",Je,[Ke,e(W,{dense:"",outlined:"",modelValue:K.value,"onUpdate:modelValue":p[0]||(p[0]=_=>K.value=_),type:"text",maxlength:"15",placeholder:"Ingresa tu nombre de usuario",class:ae(["q-mt-xs",{"error-back":y.value}]),rules:H(_e),"no-error-icon":!0,ref_key:"refUsername",ref:i,onBlur:p[1]||(p[1]=_=>K.value?"":E()),"hide-bottom-space":!(i.value&&i.value.hasError)},null,8,["modelValue","class","rules","hide-bottom-space"]),y.value?(c(),b("span",We,q(y.value),1)):U("",!0)]),a("div",Xe,[Ye,e(W,{dense:"",outlined:"",modelValue:Z.value,"onUpdate:modelValue":p[2]||(p[2]=_=>Z.value=_),type:"text",placeholder:"Ingresa tu nombres completos",class:"q-mt-xs",rules:H(ye),"no-error-icon":!0,ref_key:"refFullname",ref:l,onBlur:p[3]||(p[3]=_=>F()),"hide-bottom-space":!(l.value&&l.value.hasError)},null,8,["modelValue","rules","hide-bottom-space"])]),a("div",Ze,[ea,e(W,{dense:"",outlined:"",modelValue:ee.value,"onUpdate:modelValue":p[4]||(p[4]=_=>ee.value=_),type:"email",placeholder:"Ingresa tu nombre de usuario",class:ae(["q-mt-xs",{"error-back":g.value}]),rules:H(he),"no-error-icon":!0,ref_key:"refEmail",ref:s,onBlur:p[5]||(p[5]=_=>J()),"hide-bottom-space":!(s.value&&s.value.hasError)},null,8,["modelValue","class","rules","hide-bottom-space"]),g.value?(c(),b("span",aa,q(g.value),1)):U("",!0)]),a("div",ta,[a("div",sa,[L(e(k,{"no-caps":"",unelevated:"",color:"grey-6",label:"Cancelar",size:"0.8rem"},null,512),[[N]]),e(k,{"no-caps":"",unelevated:"",ripple:!1,color:"primary",size:"0.8rem",label:S.value.id?"Actualizar":"Agregar",type:"submit",loading:h.value},{loading:o(()=>[e(V,{size:"20px"})]),_:1},8,["label","loading"])])])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","position"]))}});var oa=O(la,[["__scopeId","data-v-58bcdd20"]]);const ra={class:"flex column justify-center items-center"},na={class:"btn-actions q-gutter-x-md q-mt-md"},ia=z({__name:"DialogDeleteUser",props:{userSelect:{type:Object,required:!1},openDialog:{type:Boolean,required:!0}},setup(r){const f=r,v=Q(),n=u(!1),m=u(null),d=u(!1),t=async()=>{var i;d.value=!0;try{await Se(f.userSelect.id),d.value=!1,m.value.hide(),w("success","Usuario eliminado correctamente."),v.isLoadingTable=!0,await v.getUsersStore()}catch(l){l instanceof j&&console.log((i=l.response)==null?void 0:i.data)}};return P(()=>f.openDialog,()=>{n.value=!0}),(i,l)=>(c(),$(G,{modelValue:n.value,"onUpdate:modelValue":l[1]||(l[1]=s=>n.value=s),persistent:"",ref_key:"refDialog",ref:m},{default:o(()=>[e(M,{class:"card-user"},{default:o(()=>[e(T,null,{default:o(()=>{var s;return[a("div",ra,[e(D,{name:"fa-solid fa-circle-exclamation",color:"grey-4",size:"2.5rem",class:"q-mb-md"}),a("span",null," \xBFEsta seguro que desea eliminar al usuario "+q((s=r.userSelect)==null?void 0:s.username)+" ? ",1)]),a("div",na,[L(e(k,{"no-caps":"",unelevated:"",color:"grey-6",label:"Cancelar",size:"0.9rem"},null,512),[[N]]),e(k,{"no-caps":"",unelevated:"",color:"red",label:"Eliminar",size:"0.9rem",onClick:l[0]||(l[0]=h=>t()),loading:d.value},{loading:o(()=>[e(V,{size:"20px"})]),_:1},8,["loading"])])]}),_:1})]),_:1})]),_:1},8,["modelValue"]))}});var ua=O(ia,[["__scopeId","data-v-59944c38"]]);const ca={class:"flex column justify-center items-center"},da={class:"btn-actions q-gutter-x-md q-mt-md"},ma=z({__name:"DialogResetUser",props:{userSelect:{type:Object,required:!1},openDialog:{type:Boolean,required:!0}},setup(r){const f=r,v=Q(),n=u(!1),m=u(null),d=u(!1),t=async()=>{var i;d.value=!0;try{await De(f.userSelect.id),d.value=!1,m.value.hide(),w("success","La contrasela fue reseteado correctamente."),v.isLoadingTable=!0,await v.getUsersStore()}catch(l){l instanceof j&&console.log((i=l.response)==null?void 0:i.data)}};return P(()=>f.openDialog,()=>{n.value=!0}),(i,l)=>(c(),$(G,{modelValue:n.value,"onUpdate:modelValue":l[1]||(l[1]=s=>n.value=s),persistent:"",ref_key:"refDialog",ref:m},{default:o(()=>[e(M,{class:"card-user"},{default:o(()=>[e(T,null,{default:o(()=>{var s;return[a("div",ca,[e(D,{name:"fa-solid fa-circle-exclamation",color:"grey-4",size:"2.5rem",class:"q-mb-md"}),a("span",null," La contrase\xF1a del usuario "+q((s=r.userSelect)==null?void 0:s.username)+' ser\xE1 reseteado a "123456". ',1)]),a("div",da,[L(e(k,{"no-caps":"",unelevated:"",color:"grey-6",label:"Cancelar",size:"0.9rem"},null,512),[[N]]),e(k,{"no-caps":"",unelevated:"",color:"positive",label:"Resetear",size:"0.9rem",onClick:l[0]||(l[0]=h=>t()),loading:d.value},{loading:o(()=>[e(V,{size:"20px"})]),_:1},8,["loading"])])]}),_:1})]),_:1})]),_:1},8,["modelValue"]))}});var pa=O(ma,[["__scopeId","data-v-4388bc7c"]]);const fa={class:"flex column justify-center items-center"},va={key:0},ga={key:1},_a={class:"btn-actions q-gutter-x-md q-mt-md"},ya=z({__name:"DialogChangeStatusUser",props:{userSelect:{type:Object,required:!1},openDialog:{type:Boolean,required:!0}},setup(r){const f=r,v=Q(),n=u(!1),m=u(null),d=u(!1),t=async i=>{var l;d.value=!0;try{await ke(f.userSelect.id,i),m.value.hide(),i==1?w("success","Usuario habilitado correctamente."):w("success","Usuario deshabilitado correctamente."),v.isLoadingTable=!0,await v.getUsersStore()}catch(s){s instanceof j&&console.log((l=s.response)==null?void 0:l.data)}finally{d.value=!1}};return P(()=>f.openDialog,()=>{n.value=!0}),(i,l)=>(c(),$(G,{modelValue:n.value,"onUpdate:modelValue":l[2]||(l[2]=s=>n.value=s),persistent:"",ref_key:"refDialog",ref:m},{default:o(()=>[e(M,{class:"card-user"},{default:o(()=>[e(T,null,{default:o(()=>{var s,h,y,g,E,F;return[a("div",fa,[e(D,{name:"fa-solid fa-circle-exclamation",color:"grey-4",size:"2.5rem",class:"q-mb-md"}),((s=r.userSelect)==null?void 0:s.active)==0?(c(),b("span",va," \xBFEsta seguro que desea habilitar a "+q((h=r.userSelect)==null?void 0:h.name)+" ? ",1)):U("",!0),((y=r.userSelect)==null?void 0:y.active)==1?(c(),b("span",ga," \xBFEsta seguro que desea deshabilitar a "+q((g=r.userSelect)==null?void 0:g.name)+" ? ",1)):U("",!0)]),a("div",_a,[L(e(k,{"no-caps":"",unelevated:"",color:"grey-6",label:"Cancelar",size:"0.9rem"},null,512),[[N]]),((E=r.userSelect)==null?void 0:E.active)==0?(c(),$(k,{key:0,"no-caps":"",unelevated:"",color:"positive",label:"Habilitar",size:"0.9rem",onClick:l[0]||(l[0]=J=>t(1)),loading:d.value},{loading:o(()=>[e(V,{size:"20px"})]),_:1},8,["loading"])):U("",!0),((F=r.userSelect)==null?void 0:F.active)==1?(c(),$(k,{key:1,"no-caps":"",unelevated:"",color:"negative",label:"Deshabilitar",size:"0.9rem",onClick:l[1]||(l[1]=J=>t(0)),loading:d.value},{loading:o(()=>[e(V,{size:"20px"})]),_:1},8,["loading"])):U("",!0)])]}),_:1})]),_:1})]),_:1},8,["modelValue"]))}});var ha=O(ya,[["__scopeId","data-v-5506ba45"]]);const ba=a("div",{class:"text-center q-my-md"},[a("span",{class:"q-page-header"},"Gesti\xF3n de Usuarios")],-1),Ua={class:"flex justify-end q-mb-md"},xa=a("span",null,"Agregar usuario",-1),Ga=z({__name:"UserPage",setup(r){const f=Q(),v=u(!1),n=u(!1),m=u(!1),d=u(!1),t=u(),i=async g=>{await f.getUserStore(g),v.value=!v.value},l=g=>{t.value=g,n.value=!n.value},s=g=>{t.value=g,m.value=!m.value},h=g=>{t.value=g,d.value=!d.value},y=C(()=>f.isLoadingPage);return C(()=>f.users),ce(async()=>{await f.getUsersStore()}),de(()=>{f.isLoadingPage=!0}),(g,E)=>(c(),b(X,null,[y.value?U("",!0):(c(),$(me,{key:0,class:"container"},{default:o(()=>[ba,a("div",Ua,[e(k,{"no-caps":"",unelevated:"",ripple:!1,color:"primary",size:"0.8rem",onClick:E[0]||(E[0]=F=>v.value=!v.value)},{default:o(()=>[e(D,{name:"fa-solid fa-plus",size:"0.7rem",class:"q-mr-sm"}),xa]),_:1})]),e(je,{openDialogUpdateUser:i,openDialogDeleteUser:l,openDialogResetUser:s,openChangeStatusUser:h}),e(oa,{openDialog:v.value},null,8,["openDialog"]),e(pa,{openDialog:m.value,userSelect:t.value},null,8,["openDialog","userSelect"]),e(ha,{openDialog:d.value,userSelect:t.value},null,8,["openDialog","userSelect"]),e(ua,{openDialog:n.value,userSelect:t.value},null,8,["openDialog","userSelect"])]),_:1})),e(le,{showing:y.value},{default:o(()=>[e(V,{size:"35px",color:"primary"})]),_:1},8,["showing"])],64))}});export{Ga as default};
