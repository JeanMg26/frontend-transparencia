import{C as B,r as x,o as P,D as _,H as h,G as a,F as l,Q as I,O as t,E as U,J as A,T as R,M as p,_ as D,P as L,R as N,S as M,aL as J,a0 as H,q as W,a1 as K,W as X,N as Y}from"./index.4f03f91b.js";import{Q as w}from"./QInput.d45c9e43.js";import{a as Z,b as ee}from"./QFile.8559c7a1.js";import{Q as $}from"./QSpinnerBars.faaa4498.js";import{i as te,Q as ae,b as oe,d as ie}from"./validation.d8c4b050.js";import{Q as se,a as re}from"./QCard.15344bc4.js";import{Q as le}from"./QPage.93c896a6.js";import{Q as ne}from"./QInnerLoading.87f5c047.js";import{u as ce}from"./use-quasar.907afb26.js";import{u as T}from"./Activity.f707e19b.js";import{q as de,A as E,z as ue,n as F,B as me}from"./api_rest.be0b8500.js";import{Q as pe}from"./QTooltip.0294f36c.js";import{Q as C}from"./QImg.58aea539.js";import"./use-dark.187236d0.js";import"./uid.42677368.js";import"./focus-manager.02955f48.js";import"./QMenu.01207d27.js";import"./position-engine.11586397.js";import"./selection.82da9296.js";import"./use-model-toggle.422ce669.js";import"./use-transition.9e1010fb.js";import"./QItem.a981c44f.js";import"./use-fullscreen.b2080330.js";import"./format.2bc25e5f.js";import"./axios.beb5d2fc.js";const S=u=>(L("data-v-e0e0e6b2"),u=u(),N(),u),_e={class:"q-mt-md"},ve=S(()=>t("span",{class:"q-label"},"Subir una imagen",-1)),fe=S(()=>t("span",{class:"text-red"},"*",-1)),ge=S(()=>t("span",{style:{"font-size":"0.8rem"}}," M\xE1ximo 2MB en formatos JPEG/JPG/PNG ",-1)),ye={class:"q-mt-xs q-gutter-sm"},he=S(()=>t("span",null,"Cargar",-1)),xe={key:0,class:"q-mt-xs"},be=S(()=>t("span",{class:"q-label-error"}," Por favor, seleccione una imagen. ",-1)),qe=[be],Ie=B({__name:"UploadImage",emits:["emitImageUpload"],setup(u,{emit:v}){const k=v,b=T(),s=x(),d=x(null),e=x(null),y=()=>{e.value.resetValidation()},q=()=>{e.value.pickFiles()},Q=()=>{s.value="",e.value.removeFile(),b.activity.url_img=""},z=async m=>{console.log(m);let r=new FileReader;r.onload=function(n){s.value=n.target.result},r.readAsDataURL(m),V()},V=async()=>{var r;const m=new FormData;m.append("path",d.value);try{const{data:{id_image:n}}=await de(m);k("emitImageUpload",n)}catch(n){n instanceof E&&console.log((r=n.response)==null?void 0:r.data)}},o=P(()=>b.activity);return(m,r)=>(_(),h("div",_e,[ve,fe,a(I,{name:"fa-solid fa-circle-info",class:"q-ml-xs cursor-pointer",color:"grey-6",size:"0.8rem"},{default:l(()=>[a(pe,{anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:l(()=>[ge]),_:1})]),_:1}),t("div",ye,[o.value.url_img&&!s.value?(_(),U(C,{key:0,class:"image-preview",src:o.value.url_img},{default:l(()=>[a(I,{class:"icon-remove",size:"1.2rem",name:"fa-solid fa-circle-xmark",color:"primary",onClick:Q})]),_:1},8,["src"])):A("",!0),s.value?(_(),U(C,{key:1,class:"image-preview",src:s.value},{default:l(()=>[a(I,{class:"icon-remove",size:"1.2rem",name:"fa-solid fa-circle-xmark",color:"primary",onClick:Q})]),_:1},8,["src"])):A("",!0),a(R,{unelevated:"",outline:"","no-caps":"",color:"primary",class:"btn-upload-file",onClick:q},{default:l(()=>[a(I,{size:"1rem",name:"fa-solid fa-upload"}),he]),_:1})]),a(Z,{modelValue:d.value,"onUpdate:modelValue":[r[0]||(r[0]=n=>d.value=n),z],outlined:"",class:"q-mt-xs hidden",ref_key:"refUploadImage",ref:e,accept:".jpg,.jpeg,.png",rules:o.value.id?[]:p(te),"no-error-icon":!0,onBlur:r[1]||(r[1]=n=>d.value?"":y()),"hide-bottom-space":!(e.value&&e.value.hasError)},null,8,["modelValue","rules","hide-bottom-space"]),e.value&&e.value.hasError?(_(),h("div",xe,qe)):A("",!0)]))}});var Ae=D(Ie,[["__scopeId","data-v-e0e0e6b2"]]);const g=u=>(L("data-v-78b5737d"),u=u(),N(),u),Se={class:"q-mb-md"},ke={class:"container-link q-mb-md"},Qe=g(()=>t("span",null," Regresar ",-1)),ze={class:"text-center"},Ve={key:0,class:"q-page-header"},we={key:1,class:"q-page-header"},Pe={class:"row q-col-gutter-x-lg"},Ue={class:"col-12"},Ee=g(()=>t("span",{class:"q-label-input"},"T\xEDtulo",-1)),$e=g(()=>t("span",{class:"text-red"},"*",-1)),Fe={class:"col-12 q-mt-md"},Ce=g(()=>t("span",{class:"q-label-input"},"Autor",-1)),Be=g(()=>t("span",{class:"q-ml-xs",style:{"font-size":"0.8rem"}},"(opcional)",-1)),Re={class:"col-12"},De={class:"col-12 q-mt-md"},Le=g(()=>t("span",{class:"q-label-input"},"Cuerpo de la publicaci\xF3n",-1)),Ne=g(()=>t("span",{class:"text-red"},"*",-1)),Te={key:0,class:"q-label-error"},Oe={class:"col-12 q-mt-md flex justify-center"},je=B({__name:"OperationActivity",setup(u){const v=ce(),k=M(),b=J(),s=T(),d=x(!1),e=H({title:"",autor:"",description:"",id_image:"",description_verify:""}),y=x(null),q=x(null),Q=()=>{y.value.resetValidation()},z=c=>{e.id_image=c,console.log(c)},V=c=>{e.description_verify=c},o=P(()=>s.activity),m=P(()=>s.isLoadingPageSingle),r=async()=>{var c;d.value=!0;try{await ue({title:e.title,autor:e.autor,storage_id:e.id_image,description:e.description}),F("success","Actividad creada correctamente."),k.push({name:"ActivityPage"})}catch(i){i instanceof E&&console.log((c=i.response)==null?void 0:c.data)}finally{d.value=!1}},n=async()=>{var c;d.value=!0;try{await me(o.value.id,{title:e.title?e.title:o.value.title,autor:e.autor?e.autor:o.value.autor,storage_id:e.id_image?e.id_image:o.value.id_img,description:e.description?e.description:o.value.description}),F("success","Actividad actualizado correctamente."),k.push({name:"ActivityPage"})}catch(i){i instanceof E&&console.log((c=i.response)==null?void 0:c.data)}finally{d.value=!1}},O=async()=>{o.value.id?n():r()},j=()=>{e.title=o.value.title,e.autor=o.value.autor,e.description=o.value.description};return W(async()=>{b.params.id?(await s.getActivityStore(Number(b.params.id)),j(),e.description_verify=o.value.description):s.isLoadingPageSingle=!1}),K(()=>{s.cleanActivityStore(),s.isLoadingPageSingle=!0}),(c,i)=>{const G=X("router-link");return _(),h(Y,null,[m.value?A("",!0):(_(),U(le,{key:0,padding:""},{default:l(()=>[t("div",Se,[t("div",ke,[a(G,{to:{name:"ActivityPage"}},{default:l(()=>[a(I,{name:"fa-solid fa-chevron-left",size:"0.7rem",class:"q-mr-xs"}),Qe]),_:1})]),t("div",ze,[o.value.id?(_(),h("span",we," Actualizar Actividad ")):(_(),h("span",Ve," A\xF1adir una Actividad "))])]),a(re,{flat:"",bordered:"",class:"card-article"},{default:l(()=>[a(se,null,{default:l(()=>[a(ae,{onSubmit:O,greedy:"","no-error-focus":""},{default:l(()=>[t("div",Pe,[t("div",Ue,[Ee,$e,a(w,{dense:"",outlined:"",modelValue:e.title,"onUpdate:modelValue":i[0]||(i[0]=f=>e.title=f),type:"text",placeholder:"Ingresar el t\xEDtulo",class:"q-mt-xs",rules:p(oe),"no-error-icon":!0,ref_key:"refTitle",ref:y,onBlur:i[1]||(i[1]=f=>e.title?"":Q()),"hide-bottom-space":!(y.value&&y.value.hasError)},null,8,["modelValue","rules","hide-bottom-space"])]),t("div",Fe,[Ce,Be,a(w,{outlined:"",autogrow:"",dense:"",rows:"2",modelValue:e.autor,"onUpdate:modelValue":i[2]||(i[2]=f=>e.autor=f),type:"textarea",placeholder:"Ingresar el nombre del autor",class:"q-mt-xs"},null,8,["modelValue"])]),t("div",Re,[a(Ae,{onEmitImageUpload:z})]),t("div",De,[Le,Ne,a(ee,{modelValue:e.description,"onUpdate:modelValue":[i[3]||(i[3]=f=>e.description=f),V],class:"q-mt-xs",toolbar:[[{label:p(v).lang.editor.align,icon:p(v).iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]},{label:p(v).lang.editor.fontSize,icon:p(v).iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:p(v).lang.editor.formatting,icon:p(v).iconSet.editor.formatting,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]}],["bold","italic","strike","underline"],["quote","unordered","ordered","outdent","indent"],["viewsource"]]},null,8,["modelValue","toolbar"]),a(w,{dense:"",outlined:"",modelValue:e.description_verify,"onUpdate:modelValue":i[4]||(i[4]=f=>e.description_verify=f),type:"text",placeholder:"Ingresar el t\xEDtulo",class:"q-mt-xs hidden",rules:p(ie),ref_key:"refDescription",ref:q},null,8,["modelValue","rules"]),q.value&&q.value.hasError?(_(),h("span",Te," Por favor, ingrese una descripci\xF3n para la publicaci\xF3n. ")):A("",!0)]),t("div",Oe,[a(R,{"no-caps":"",unelevated:"",ripple:!1,color:"primary",label:o.value.id?"Actualizar actividad":"Agregar actividad",type:"submit",loading:d.value},{loading:l(()=>[a($,{size:"20px"})]),_:1},8,["label","loading"])])])]),_:1})]),_:1})]),_:1})]),_:1})),a(ne,{showing:m.value},{default:l(()=>[a($,{size:"35px",color:"primary"})]),_:1},8,["showing"])],64)}}});var ft=D(je,[["__scopeId","data-v-78b5737d"]]);export{ft as default};
