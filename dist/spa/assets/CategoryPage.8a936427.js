import{C as Q,D as c,E as D,F as o,O as a,H as C,G as e,I as J,L as E,M,Q as S,J as w,N as Y,_ as B,P as F,R as L,r as m,a0 as K,o as x,w as V,v as z,aq as W,T as k,q as X,a1 as Z}from"./index.4f03f91b.js";import{Q as ee,N as ae,a as te}from"./NoResults.67ae0d4a.js";import{Q as oe}from"./QPage.93c896a6.js";import{Q as I}from"./QSpinnerBars.faaa4498.js";import{Q as G}from"./QInnerLoading.87f5c047.js";import{u as U}from"./Category.749128ae.js";import{Q as j}from"./QTooltip.0294f36c.js";import{d as re}from"./date.f0f289d7.js";import{Q as T,a as H}from"./QCard.15344bc4.js";import{Q as se}from"./QInput.d45c9e43.js";import{Q as le,a as ne}from"./validation.d8c4b050.js";import{Q as R}from"./QDialog.a4be6c36.js";import{C as N}from"./ClosePopup.0885fbba.js";import{h as ie,n as P,A,i as ce,j as de}from"./api_rest.be0b8500.js";import"./use-dark.187236d0.js";import"./format.2bc25e5f.js";import"./use-transition.9e1010fb.js";import"./position-engine.11586397.js";import"./selection.82da9296.js";import"./focus-manager.02955f48.js";import"./use-model-toggle.422ce669.js";import"./uid.42677368.js";import"./use-prevent-scroll.adeeee81.js";import"./axios.beb5d2fc.js";const O=t=>(F("data-v-6befbcbe"),t=t(),L(),t),ue=O(()=>a("thead",{class:"bg-grey-2"},[a("tr",null,[a("th",{class:"text-left"},"Fecha de creaci\xF3n"),a("th",{class:"text-left"},"Nombre"),a("th",{class:"text-right"},"Acciones")])],-1)),me={key:0,class:"q-tr--no-hover"},ge={colspan:"3"},pe={class:"text-left"},fe={class:"text-left"},_e={class:"text-right"},ve={class:"q-gutter-x-md"},ye=O(()=>a("span",null,"Editar",-1)),Ce=O(()=>a("span",null,"Eliminar",-1)),he=Q({__name:"TableDesktopCategory",props:{openDialogUpdateCat:{type:Function,required:!0},openDialogDeleteCat:{type:Function,required:!0},categoriesState:{type:Object,required:!0},loadingTableState:{type:Boolean,required:!0}},setup(t){return(d,l)=>(c(),D(ee,{flat:"",bordered:""},{default:o(()=>{var n;return[ue,a("tbody",null,[(n=t.categoriesState)!=null&&n.length?(c(!0),C(Y,{key:1},J(t.categoriesState,(i,r)=>(c(),C("tr",{key:r},[a("td",pe,E(M(re).formatDate(i.created_at,"DD-MM-YYYY HH:mm:ss")),1),a("td",fe,E(i.name),1),a("td",_e,[a("div",ve,[e(S,{name:"fa-solid fa-edit",color:"primary",class:"cursor-pointer",onClick:p=>t.openDialogUpdateCat(i.id)},{default:o(()=>[e(j,{anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:o(()=>[ye]),_:1})]),_:2},1032,["onClick"]),i.article.length<=0?(c(),D(S,{key:0,name:"fa-regular fa-trash-can",color:"red",class:"cursor-pointer",onClick:p=>t.openDialogDeleteCat(i.id)},{default:o(()=>[e(j,{anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:o(()=>[Ce]),_:1})]),_:2},1032,["onClick"])):w("",!0)])])]))),128)):(c(),C("tr",me,[a("td",ge,[e(ae)])])),e(G,{showing:t.loadingTableState},{default:o(()=>[e(I,{size:"35px",color:"primary"})]),_:1},8,["showing"])])]}),_:1}))}});var be=B(he,[["__scopeId","data-v-6befbcbe"]]);const De=t=>(F("data-v-85062100"),t=t(),L(),t),xe={class:"flex justify-between items-center"},Se={key:0,class:"q-dialog-header"},ke={key:1,class:"q-dialog-header"},qe={class:"row"},$e={class:"col-12"},we=De(()=>a("span",{class:"q-label-input"},"Nombre de la categoria",-1)),Qe={key:0,class:"q-label-error"},Ie={class:"col-12 q-mt-lg"},Ee={class:"btn-actions q-gutter-x-md"},Ve=Q({__name:"DialogOperationCategory",props:{openDialog:{type:Boolean,required:!0}},setup(t){const d=t,l=U(),n=m(!1),i=m(null),r=K({name:""}),p=m(null),g=m(""),s=m(!1),y=()=>{p.value.resetValidation()},_=x(()=>l.category),q=x({get(){return r.name?r.name:_.value.name},set(v){r.name=v}}),h=async()=>{var v;s.value=!0;try{await ie({name:r.name}),s.value=!1,i.value.hide(),P("success","Categoria creada correctamente."),l.isLoadingTable=!0,await l.getCategoriesStore()}catch(u){if(u instanceof A){let f=(v=u.response)==null?void 0:v.data.errors.name;f&&f[0]==1003&&(g.value="Este nombre ya est\xE1 registrado")}}finally{s.value=!1}},b=async()=>{var v;s.value=!0;try{await ce(_.value.id,{name:r.name?r.name:_.value.name}),s.value=!1,i.value.hide(),P("success","Categoria actualizada correctamente."),l.isLoadingTable=!0,await l.getCategoriesStore()}catch(u){if(u instanceof A){let f=(v=u.response)==null?void 0:v.data.errors.name;f&&f[0]==1003&&(g.value="Este nombre ya est\xE1 registrado")}}finally{s.value=!1}},$=()=>{_.value.id?b():h()};return V(()=>d.openDialog,()=>{n.value=!0}),V(n,()=>{n.value||(r.name="",l.cleanCategoryStore())}),(v,u)=>(c(),D(R,{modelValue:n.value,"onUpdate:modelValue":u[2]||(u[2]=f=>n.value=f),persistent:"",ref_key:"refDialog",ref:i,position:v.$q.screen.width<600?"bottom":"standard"},{default:o(()=>[e(H,{class:"card-add-category"},{default:o(()=>[e(T,null,{default:o(()=>[a("div",xe,[_.value.id?(c(),C("span",ke,"Actualizar una categoria")):(c(),C("span",Se," Agregar una categoria ")),z(e(S,{name:"fa-solid fa-xmark",size:"1.1rem",class:"cursor-pointer"},null,512),[[N]])])]),_:1}),e(T,null,{default:o(()=>[e(le,{onSubmit:$,greedy:"","no-error-focus":""},{default:o(()=>[a("div",qe,[a("div",$e,[we,e(se,{dense:"",outlined:"",modelValue:q.value,"onUpdate:modelValue":u[0]||(u[0]=f=>q.value=f),type:"text",class:W(["q-mt-xs",{"error-back":g.value}]),placeholder:"Ingresar un nombre",maxlength:"30",rules:M(ne),"no-error-icon":!0,ref_key:"refNameCat",ref:p,onBlur:u[1]||(u[1]=f=>r.name?"":y()),"hide-bottom-space":!(p.value&&p.value.hasError)},null,8,["modelValue","class","rules","hide-bottom-space"]),g.value?(c(),C("span",Qe,E(g.value),1)):w("",!0)]),a("div",Ie,[a("div",Ee,[z(e(k,{"no-caps":"",unelevated:"",color:"grey-5",type:"button",label:"Cancelar"},null,512),[[N]]),e(k,{"no-caps":"",unelevated:"",color:"primary",type:"submit",label:_.value.id?"Actualizar":"Guardar",loading:s.value},{loading:o(()=>[e(I,{size:"20px"})]),_:1},8,["label","loading"])])])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","position"]))}});var ze=B(Ve,[["__scopeId","data-v-85062100"]]);const Te=t=>(F("data-v-a9a397e6"),t=t(),L(),t),Ne={class:"flex column justify-center items-center"},Pe=Te(()=>a("span",null,"\xBFEsta seguro que desea eliminar esta categor\xEDa?",-1)),Ae={class:"btn-actions q-gutter-x-md q-mt-md"},Be=Q({__name:"DialogDeleteCategory",props:{openDialog:{type:Boolean,required:!0},catID:{type:Number,required:!1}},setup(t){const d=t,l=U(),n=m(!1),i=m(null),r=m(!1),p=async()=>{var g;r.value=!0;try{await de(d.catID),P("success","Categoria eliminada correctamente"),i.value.hide(),l.isLoadingTable=!0,await l.getCategoriesStore()}catch(s){s instanceof A&&console.log((g=s.response)==null?void 0:g.data)}finally{r.value=!1}};return V(()=>d.openDialog,()=>{n.value=!0}),(g,s)=>(c(),D(R,{modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=y=>n.value=y),persistent:"",ref_key:"refDialog",ref:i},{default:o(()=>[e(H,{class:"card-user"},{default:o(()=>[e(T,null,{default:o(()=>[a("div",Ne,[e(S,{name:"fa-solid fa-circle-exclamation",color:"grey-4",size:"2.5rem",class:"q-mb-md"}),Pe]),a("div",Ae,[z(e(k,{"no-caps":"",unelevated:"",color:"grey-6",label:"Cancelar",size:"0.9rem"},null,512),[[N]]),e(k,{"no-caps":"",unelevated:"",color:"red",label:"Eliminar",size:"0.9rem",loading:r.value,onClick:s[0]||(s[0]=y=>p())},{loading:o(()=>[e(I,{size:"20px"})]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});var Fe=B(Be,[["__scopeId","data-v-a9a397e6"]]);const Le=a("div",{class:"text-center q-my-md"},[a("span",{class:"q-page-header"},"Gesti\xF3n de Categorias")],-1),Ue={class:"flex justify-end q-mb-md"},Oe=a("span",null,"Agregar una categoria",-1),ga=Q({__name:"CategoryPage",setup(t){const d=U(),l=m(!1),n=m(!1),i=m(),r=m(1),p=()=>{l.value=!l.value},g=async h=>{await d.getCategoryStore(h),l.value=!l.value},s=h=>{i.value=h,n.value=!n.value},y=x(()=>d.categories),_=x(()=>d.isLoadingPage),q=x(()=>d.isLoadingTable);return X(async()=>{await d.getCategoriesStore(1)}),Z(()=>{d.isLoadingPage=!0}),(h,b)=>(c(),C(Y,null,[_.value?w("",!0):(c(),D(oe,{key:0,class:"container"},{default:o(()=>[Le,a("div",Ue,[e(k,{"no-caps":"",unelevated:"",ripple:!1,color:"primary",size:"0.8rem",onClick:b[0]||(b[0]=$=>p())},{default:o(()=>[e(S,{name:"fa-solid fa-circle-plus",size:"1rem",class:"q-mr-sm"}),Oe]),_:1})]),a("div",null,[e(be,{openDialogUpdateCat:g,openDialogDeleteCat:s,categoriesState:y.value,loadingTableState:q.value},null,8,["categoriesState","loadingTableState"]),y.value.length?(c(),D(te,{key:0,size:"0.8rem",class:"fles justify-end q-mt-md",modelValue:r.value,"onUpdate:modelValue":b[1]||(b[1]=$=>r.value=$),max:"1","direction-links":"",outline:"",color:"primary","active-design":"unelevated","active-color":"primary","active-text-color":"white"},null,8,["modelValue"])):w("",!0)]),e(ze,{"open-dialog":l.value},null,8,["open-dialog"]),e(Fe,{"open-dialog":n.value,catID:i.value},null,8,["open-dialog","catID"])]),_:1})),e(G,{showing:_.value},{default:o(()=>[e(I,{size:"35px",color:"primary"})]),_:1},8,["showing"])],64))}});export{ga as default};
