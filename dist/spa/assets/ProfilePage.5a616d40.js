import{Q as f}from"./QInput.d45c9e43.js";import{Q as X}from"./QSeparator.02c5b664.js";import{_ as Y,C as Z,S as ee,r as t,a0 as ae,o as v,D as n,H as C,E as w,F as d,J as i,G as o,N as se,O as s,aq as m,M as _,L as $,Q as N,T as L,P as re,R as oe}from"./index.4f03f91b.js";import{Q as G}from"./QSpinnerBars.faaa4498.js";import{Q as le,u as te,f as ne,e as ue,c as de,n as ie}from"./validation.d8c4b050.js";import{Q as me,a as ce}from"./QCard.15344bc4.js";import{Q as pe}from"./QPage.93c896a6.js";import{Q as fe}from"./QInnerLoading.87f5c047.js";import{u as ve}from"./Profile.d08e8c40.js";import{f as H,n as we,A as _e}from"./api_rest.be0b8500.js";import"./use-dark.187236d0.js";import"./uid.42677368.js";import"./focus-manager.02955f48.js";import"./use-transition.9e1010fb.js";import"./axios.beb5d2fc.js";const u=y=>(re("data-v-7d00275b"),y=y(),oe(),y),ye=u(()=>s("span",{class:"q-page-header"},"Perfil de Usuario",-1)),be=[ye],qe={class:"row q-col-gutter-x-lg"},he={class:"col-12 col-md-5"},ge=u(()=>s("span",{class:"q-label-input"},"Nombre de Usuario",-1)),xe=u(()=>s("span",{class:"text-red q-ml-xs"},"*",-1)),Pe={key:0,class:"q-label-error"},Ee=u(()=>s("span",{class:"q-label-input"},"Nombres y Apellidos",-1)),Ve=u(()=>s("span",{class:"text-red q-ml-xs"},"*",-1)),ke={class:"col-12 q-mt-md"},Qe=u(()=>s("span",{class:"q-label-input"},"Correo electr\xF3nico",-1)),Se=u(()=>s("span",{class:"text-red q-ml-xs"},"*",-1)),Be={key:0,class:"q-label-error"},Ce={class:"col-12 q-my-md"},Ne={class:"col-12 col-md-6"},Fe=u(()=>s("span",{class:"q-label-input"},"Contrase\xF1a Actual",-1)),Ie={key:0,class:"q-label-error"},$e=u(()=>s("span",{class:"q-label-input"},"Nueva Contrase\xF1a",-1)),Ue={class:"col-12 text-center q-mt-xl"},ze={class:"q-gutter-md"},Ae=Z({__name:"ProfilePage",setup(y){const J=ee(),U=ve(),c=t(!1),p=t(!1),e=ae({username:"",fullname:"",email:"",password:"",new_password:""}),b=t(null),q=t(null),h=t(null),g=t(null),x=t(null),F=t(!1),P=t(""),E=t(""),V=t(""),M=()=>{b.value.resetValidation()},O=()=>{h.value.resetValidation()},T=()=>{q.value.resetValidation()},j=()=>{e.password||g.value.resetValidation()},K=()=>{e.new_password||x.value.resetValidation()},I=v(()=>U.profile),z=v(()=>U.isLoadingPage),k=v({get(){return e.username?e.username:I.value.username},set(l){e.username=l}}),Q=v({get(){return e.fullname?e.fullname:I.value.name},set(l){e.fullname=l}}),S=v({get(){return e.email?e.email:I.value.email},set(l){e.email=l}}),W=async()=>{var l,a,r;F.value=!0;try{e.password?await H({name:e.fullname?e.fullname:Q.value,username:e.username?e.username:k.value,email:e.email?e.email:S.value,password:e.password,new_password:e.new_password}):await H({name:e.fullname?e.fullname:Q.value,username:e.username?e.username:k.value,email:e.email?e.email:S.value}),we("success","Perfil actualizado correctamente."),J.push({name:"Dashboard"})}catch(B){if(B instanceof _e){let A=(l=B.response)==null?void 0:l.data.errors.email,R=(a=B.response)==null?void 0:a.data.errors.username,D=(r=B.response)==null?void 0:r.data.errors.password;R&&R[0]==1001&&(P.value="Este nombre de usuario ya est\xE1 registrado"),A&&A[0]==1002&&(E.value="Este email ya esta registrado"),D&&D.code==1004&&(V.value="La contrase\xF1a actual es incorrecta. ")}}finally{F.value=!1}};return(l,a)=>(n(),C(se,null,[z.value?i("",!0):(n(),w(pe,{key:0,class:"container"},{default:d(()=>[s("div",{class:m(["text-center",{"q-mt-md":l.$q.screen.width<600}])},be,2),o(ce,{flat:"",bordered:l.$q.screen.width>600,class:"card-profile"},{default:d(()=>[o(me,null,{default:d(()=>[o(le,{onSubmit:W,greedy:"","no-error-focus":""},{default:d(()=>[s("div",qe,[s("div",he,[ge,xe,o(f,{dense:"",outlined:"",modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=r=>k.value=r),type:"text",placeholder:"Ingresar tu nombre de usuario",class:m(["q-mt-xs",{"error-back":P.value}]),rules:_(te),"no-error-icon":!0,ref_key:"refUsername",ref:b,onBlur:a[1]||(a[1]=r=>M()),"hide-bottom-space":!(b.value&&b.value.hasError)},null,8,["modelValue","class","rules","hide-bottom-space"]),P.value?(n(),C("span",Pe,$(P.value),1)):i("",!0)]),s("div",{class:m(["col-12 col-md-7",{"q-mt-md":l.$q.screen.width<600}])},[Ee,Ve,o(f,{dense:"",outlined:"",modelValue:Q.value,"onUpdate:modelValue":a[2]||(a[2]=r=>Q.value=r),type:"text",placeholder:"Ingresa tus nombres completos",class:"q-mt-xs",rules:_(ne),"no-error-icon":!0,ref_key:"refFullName",ref:q,onBlur:a[3]||(a[3]=r=>T()),"hide-bottom-space":!(q.value&&q.value.hasError)},null,8,["modelValue","rules","hide-bottom-space"])],2),s("div",ke,[Qe,Se,o(f,{dense:"",outlined:"",modelValue:S.value,"onUpdate:modelValue":a[4]||(a[4]=r=>S.value=r),type:"text",class:m(["q-mt-xs",{"error-back":E.value}]),rules:_(ue),"no-error-icon":!0,ref_key:"refEmail",ref:h,onBlur:a[5]||(a[5]=r=>O()),"hide-bottom-space":!(h.value&&h.value.hasError)},null,8,["modelValue","class","rules","hide-bottom-space"]),E.value?(n(),C("span",Be,$(E.value),1)):i("",!0)]),s("div",Ce,[o(X)]),s("div",Ne,[Fe,o(f,{dense:"",outlined:"",modelValue:e.password,"onUpdate:modelValue":a[7]||(a[7]=r=>e.password=r),type:c.value?"text":"password",placeholder:"Ingresar tu contrase\xF1a actual",class:m(["q-mt-xs",{"error-back":V.value}]),rules:e.password?_(de):void 0,"no-error-icon":!0,ref_key:"refPassword",ref:g,onBlur:a[8]||(a[8]=r=>j()),"hide-bottom-space":!(g.value&&g.value.hasError)},{append:d(()=>[s("span",{onClick:a[6]||(a[6]=r=>c.value=!c.value)},[c.value?i("",!0):(n(),w(N,{key:0,name:"fa-solid fa-eye",size:"1rem",class:"cursor-pointer"})),c.value?(n(),w(N,{key:1,name:"fa-solid fa-eye-slash",size:"1rem",class:"cursor-pointer"})):i("",!0)])]),_:1},8,["modelValue","type","class","rules","hide-bottom-space"]),V.value?(n(),C("span",Ie,$(V.value),1)):i("",!0)]),s("div",{class:m(["col-12 col-md-6",{"q-mt-md":l.$q.screen.width<600}])},[$e,o(f,{dense:"",outlined:"",modelValue:e.new_password,"onUpdate:modelValue":a[10]||(a[10]=r=>e.new_password=r),type:p.value?"text":"password",placeholder:"Ingresar tu nueva contrase\xF1a",class:"q-mt-xs",rules:e.password?_(ie):void 0,"no-error-icon":!0,ref_key:"refNewPassword",ref:x,onBlur:a[11]||(a[11]=r=>K()),"hide-bottom-space":!(x.value&&x.value.hasError)},{append:d(()=>[s("span",{onClick:a[9]||(a[9]=r=>p.value=!p.value)},[p.value?i("",!0):(n(),w(N,{key:0,name:"fa-solid fa-eye",size:"1rem",class:"cursor-pointer"})),p.value?(n(),w(N,{key:1,name:"fa-solid fa-eye-slash",size:"1rem",class:"cursor-pointer"})):i("",!0)])]),_:1},8,["modelValue","type","rules","hide-bottom-space"])],2),s("div",Ue,[s("div",ze,[o(L,{"no-caps":"",unelevated:"",color:"grey-6",label:"Cancelar",class:"q-wp-150",ripple:!1,to:{name:"Dashboard"}}),o(L,{"no-caps":"",unelevated:"",color:"primary",label:"Actualizar",class:"q-wp-150",type:"submit",ripple:!1,loading:F.value},{loading:d(()=>[o(G,{size:"20px"})]),_:1},8,["loading"])])])])]),_:1})]),_:1})]),_:1},8,["bordered"])]),_:1})),o(fe,{showing:z.value},{default:d(()=>[o(G,{size:"35px",color:"primary"})]),_:1},8,["showing"])],64))}});var ea=Y(Ae,[["__scopeId","data-v-7d00275b"]]);export{ea as default};
